!function i(a,u,s){function d(e,t){if(!u[e]){if(!a[e]){var n="function"==typeof require&&require;if(!t&&n)return n(e,!0);if(c)return c(e,!0);var o=new Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}var r=u[e]={exports:{}};a[e][0].call(r.exports,function(t){return d(a[e][1][t]||t)},r,r.exports,i,a,u,s)}return u[e].exports}for(var c="function"==typeof require&&require,t=0;t<s.length;t++)d(s[t]);return d}({1:[function(t,e,n){$(function(){var t=window.app.hasOwnProperty("quizCountdownMs")?window.app.quizCountdownMs:-1,e="quiz_revealed_v2",n=$("#quiz-widget"),o=n.find(".quiz-form"),r=o.find(".quiz-group").length,i=0,a=!!o.data("debug");o.removeAttr("data-debug");var u=!1;window.app.debug&&console.log("The quiz form will be shown in",t,"ms,","now is",(new Date).toLocaleTimeString());var s=-1!==t&&!window.utils.cookies.get(e);function d(){return $("#bspopup .the-quiz")}function c(t){var e=d().find(".quiz-group").filter(".current");switch(t){case 0:return 1;case 1:var n=0<e.find('[data-attr="countries"]:checked').length,o=0<e.find('[data-attr="customCountries"]').val().trim().length,r=e.find('[data-role="customCountries"]').is(":checked");return n||r&&o;case 2:return 0<e.find('[data-attr="periods"]:checked').length;case 3:return 0<e.find('[data-attr="phone"]').val().length;default:return}}function f(){var t,e,n,o;c(i)&&(t=++i,n=d(),(o=n.find(".quiz-group")).removeClass("current"),r<=0||r<t||(o.eq(t-1).addClass("current"),(e=n.find('[data-role="progress"]')).find(".progress-indicator").text("("+t+"/"+r+")"),e.find(".progress-caption").text(t<r?"Далее":"Готово")))}function l(){var t;a&&(t=console).log.apply(t,arguments)}function p(){d().find(".quiz-feedback").removeClass("text-error").text("")}function h(t){d().find(".quiz-feedback").addClass("text-error").text(t)}s&&setTimeout(function(){!s||0<$(".modal.in").length||(s=!1,bs3popup({content:n.html(),getLock:!0,setLock:!0,onAfterShow:function(){window.utils.cookies.set(e,1,{expires:86400,path:"/"})}}),d().find("[data-mask]").each(function(t,e){var n=$(e);n.mask(n.data("mask"),{placeholder:"_"})}),f(),bs3popup("show"))},t),$("#bspopup").on("click",'.the-quiz [data-role="progress"]',function(){var t;$(this).blur(),i<r?f():(t=d(),c(r)&&t.find(".quiz-form").trigger("submit"))}).on("click",'.the-quiz [data-role="complete"]',function(){i<r||bs3popup("hide")}).on("click",'.the-quiz [data-role="customCountries"]',function(){d().find('[data-attr="customCountries"]').closest(".quiz-control").toggleClass("invisible",!$(this).is(":checked"))}).on("submit",".quiz-form",function(t){t.preventDefault();var e=$(this);return!e.closest("#bspopup").length||u||(e.find('[data-role="customCountries"]').is(":checked")||e.find('[data-attr="customCountries"]').val(""),$.ajax(this.action,{method:this.method,data:e.serialize(),beforeSend:function(){d().addClass("pending").find(".quiz-button").attr("disabled",!0),p()},error:function(t,e,n){l('Status: "'+e+'". Error: "'+n+'".'),h(n)},success:function(t){l("Data:",t=t||{}),t.success?(u=!0,d().addClass("done"),p()):h(t.message||"Ошибка, попробуйте позже"),window.tracking.setEvent("tour-quiz-form.submit")},complete:function(){d().removeClass("pending").find(".quiz-button").removeAttr("disabled")}})),!1})})},{}]},{},[1]);
//# sourceMappingURL=quiz.min.js.map
