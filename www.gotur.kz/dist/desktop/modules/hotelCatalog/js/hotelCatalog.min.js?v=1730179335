var _createClass=function(){function n(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,o){return t&&n(e.prototype,t),o&&n(e,o),e}}();function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}!function a(s,i,l){function c(t,e){if(!i[t]){if(!s[t]){var o="function"==typeof require&&require;if(!e&&o)return o(t,!0);if(u)return u(t,!0);var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}var r=i[t]={exports:{}};s[t][0].call(r.exports,function(e){return c(s[t][1][e]||e)},r,r.exports,a,s,i,l)}return i[t].exports}for(var u="function"==typeof require&&require,e=0;e<l.length;e++)c(l[e]);return c}({1:[function(e,t,o){function n(e,t,o,n){this.wrapper=e,this.bounds=t,this.onChange=n,this.setValue(o,!1),this.createHandlers()}n.prototype.createHandlers=function(){var t=this;$("button",this.wrapper).on("click",function(){var e=$(this).hasClass("next")?1:-1;t.changeValue(e)})},n.prototype.changeValue=function(e){var t=this.getValue()+e;t<this.bounds.min||t>this.bounds.max||this.setValue(t,!0)},n.prototype.setValue=function(e,t){this.wrapper.find("span").text(e),this.wrapper.find(".next, .prev").removeClass("disable"),e+1>this.bounds.max&&this.wrapper.find(".next").addClass("disable"),e-1<this.bounds.min&&this.wrapper.find(".prev").addClass("disable"),this.onChange(e,t)},n.prototype.getValue=function(){return parseInt(this.wrapper.find("span").text(),10)},t.exports=n},{}],2:[function(e,t,o){function n(e,a){e.datepicker({beforeShowDay:function(e){var t=$.datepicker.formatDate("yy-mm-dd",e);return[-1===stopDates.indexOf(t)]},minDate:1,dateFormat:"yy-mm-dd",language:"ru",onSelect:function(e){var t=new Date(e);t.setDate(t.getDate()+1);var o=a;o.datepicker("option","minDate",t),o.datepicker("option","maxDate",null);for(var n=0;n<stopDates.length;n++){var r=new Date(stopDates[n]);if(t<=r){o.datepicker("option","maxDate",r);break}}}}),a.datepicker("option","language","ru"),a.datepicker("option","dateFormat","yy-mm-dd")}$(".hotel-nav-categories ul a").on("click",function(e){e.preventDefault();var t=$(this),o=t.data("target"),n=$(o);t.toggleClass("open"),n.toggleClass("hidden")}),$(document).ready(function(){$(".scroll-to-element").on("click",function(e){var t,o=$(this).data("scrollElement"),n=$(o);n&&(e.preventDefault(),t=$(this).data("scrollOffset")||0,$([document.documentElement,document.body]).animate({scrollTop:n.offset().top-t},1e3))})}),$(document).ready(function(){var o=/([12]\d{3}-(0[1-9]|1[0-2])-(0[1-9]|[12]\d|3[01]))/;$(".date-input").on("change",function(){var e=$(this),t=e.val().match(o);null!==t?e.val(t[0]):e.val("")}),$("#requestform-phone").inputmask({mask:"+7 999 999-99-99[9{5}]",clearMaskOnLostFocus:!0}),$("#requestform-datefrom").length&&$("#requestform-dateto").length&&n($("#requestform-datefrom"),$("#requestform-dateto"))});var r=e("../../../include/counter/_js/Counter"),a=$("#kidsAges"),h="#room-search-form",v=$("#resultsTable"),s=$("#roomSubmitForm");$(document).ready(function(){$("#roomsearchform-datefrom").length&&$("#roomsearchform-dateto")&&n($("#roomsearchform-datefrom"),$("#roomsearchform-dateto"));new r($("#adultsCount"),{min:1,max:20},$("#adultsCount span").text(),function(e){$("#adultsCount span").val(e),$("#roomsearchform-adults").val(e)}),new r($("#kidsCount"),{min:0,max:10},$("#kidsCount span").text(),function(e){$("#kidsCount span").val(e),$("#roomsearchform-kids").val(e),function(e){0<e?a.removeClass("hidden"):a.addClass("hidden");var t=a.find("input"),o=[];t.each(function(){o.push($(this).val())});for(var n="",r=0;r<e;r++)n+='<input type="text" class="form-control" name="RoomSearchForm[kidsAges]['+r+']" placeholder="-" aria-required="true" value="'+(o[r]?o[r]:"")+'">';$("#kidsAges .field-roomsearchform-kidsages").html(n)}(e)});$(h).on("beforeSubmit",function(){if(t=!0,$(".field-roomsearchform-kidsages input").each(function(){var e=$(this);(""===e.val()||isNaN(e.val())||e.val()<0||16<e.val())&&(t=!1)}),!t)return $(h+" .error-summary").removeClass("hidden"),$(h+" .error-summary").show(),$(h+" .error-summary ul").prepend("<li>Возраст детей был введён неверно.</li>"),v.addClass("hidden"),!1;var t,e=$(this);return $.ajax({url:e.attr("action"),type:e.attr("method"),data:e.serialize()}).done(function(e){!function(e){if(!e.errors){if(e.rooms){var t=e.rooms;$(h+" .error-summary").addClass("hidden"),$(".room-not-found-block").addClass("hidden"),$("#searchHash").val(e.searchHash);var o=0;for(var n in t)o+=t[n].options.length;v.removeClass("hidden"),$("#optionsPriceHeader").text("Цена за "+e.nights+" "+window.utils.getnoun(e.nights,"ночь","ночи","ночей"));var r=$("#resultsBody"),a="",s=0;for(var i in t)for(var l=0;l<t[i].options.length;l++){var c="<tr>";0===l&&(c+='<td class="room-type" rowspan="'+t[i].options.length+'">',c+="<h3>"+t[i].name+'</h3><div class="room-type-description">'+t[i].description+"</div>",130<t[i].description.length&&(c+='<a class="show-room-description">Показать Описание</a>'),c+="</td>");var u='<td class="room-max-persons">';if(3<t[i].options[l].adults)u+='<span class="icon-person"></span>',u+="<span>x</span>",u+="<span>"+t[i].options[l].adults+"</span>";else for(var d=0;d<t[i].options[l].adults;d++)u+='<span class="icon-person"></span>';if(0!==t[i].options[l].kids){u+="<span>+</span>";for(var p=0;p<t[i].options[l].kids;p++)u+='<span class="icon-kid"></span>';u+='<span class="icon-information" title="'+t[i].options[l].kids_ages.toString()+" "+window.utils.getnoun(t[i].options[l].kids_ages[t[i].options[l].kids_ages.length-1],"год","года","лет")+'"></span>'}c+=u+="</td>",c+='<td class="room-price">'+t[i].options[l].price.toLocaleString()+" "+e.currency.toUpperCase()+"</td>",c+='<td class="room-select"><select name="selectedRooms['+i+"]["+l+']" id="roomsNumber_'+i+"_"+l+'" data-room-price="'+t[i].options[l].price+'" data-price-currency="'+e.currency.toUpperCase()+'">',c+='<option selected value="0">0</option>';for(var m=1;m<=10;m++)c+='<option value="'+m+'">'+m+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;("+(t[i].options[l].price*m).toLocaleString()+" "+e.currency.toUpperCase()+")</option>";c+="</select></td>",0===s&&0===l&&(c+='<td class="room-booking" rowspan="'+o+'"><div class="sticky-sidebar"><p id="roomsAmount"></p><input type="hidden" id="roomsFullPrice" name="fullPrice" value="0"><button type="submit" id="roomSubmitButton" class="btn-carrot" title="Сначала выберите вариант">Бронировать</button></div></td>'),a+=c+="</tr>",s++}return r.html(a)}return v.addClass("hidden"),$(".room-not-found-block").removeClass("hidden")}for(var f in v.addClass("hidden"),$(h+" .error-summary").show(),e.errors)$(h+" .error-summary ul").prepend("<li>"+e.errors[f]+"</li>")}(JSON.parse(e))}).fail(function(e){var t=e.status+": "+e.statusText;console.log("Ошибка - "+t)}),!1}),$(".room-search-results").on("click",".show-room-description",function(){var e=$(this);e.closest("td").children(".room-type-description").css("max-height","none"),e.remove()}),$(".room-search-results").on("change","select",function(){var e=$("#roomsAmount");$(".room-select").each(function(){$(this).removeClass("error-select")}),$(this).data("amount",$(this).val());var t=[];$(".room-select select").each(function(){var e=$(this);0<e.val()?(t.push(e.attr("id")),e.closest("tr").addClass("selected")):e.closest("tr").removeClass("selected")});var o=0,n=0,r="";t.forEach(function(e){var t=$("#"+e);o+=parseInt(t.data().amount,10),n+=t.data().roomPrice*t.data().amount,r=t.data().priceCurrency}),e.data("roomsAmount",o),o?($(".room-booking").addClass("selected"),$("#roomsFullPrice").val(n.toLocaleString()+" "+r.toUpperCase()),e.html("<strong>"+o+"</strong> номер"+window.utils.getnoun(o,"","а","ов")+" за <div><strong>"+n.toLocaleString()+" "+r.toUpperCase()+"</strong></div>")):($(".room-booking").removeClass("selected"),e.html("")),$("#roomSubmitButton").data("selected-options-ids",t)}),s.submit(function(e){var t,o;$("#roomsAmount").data().roomsAmount||(t=null,$(".room-search-results .room-select").each(function(){var e=$(this);null===t&&function(e){"function"==typeof window.jQuery&&e instanceof window.jQuery&&(e=e[0]);var t=e.getBoundingClientRect();return 0<=t.top&&0<=t.left&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)}(e.children("select"))&&(t=e)}),o=$(".error-select-tooltip-wrapper").html(),t.append('<div class="error-select-tooltip-wrapper">'+o+"</div>"),$(".error-select-tooltip-wrapper").fadeIn("slow"),setTimeout(function(){$(".error-select-tooltip-wrapper").fadeOut("slow",function(){t.children(".error-select-tooltip-wrapper").remove()})},2e3),$(".room-select").each(function(){$(this).addClass("error-select")}),e.preventDefault())})})},{"../../../include/counter/_js/Counter":1}]},{},[2]),function a(s,i,l){function c(t,e){if(!i[t]){if(!s[t]){var o="function"==typeof require&&require;if(!e&&o)return o(t,!0);if(u)return u(t,!0);var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}var r=i[t]={exports:{}};s[t][0].call(r.exports,function(e){return c(s[t][1][e]||e)},r,r.exports,a,s,i,l)}return i[t].exports}for(var u="function"==typeof require&&require,e=0;e<l.length;e++)c(l[e]);return c}({1:[function(e,t,o){var n=e("../../../../include/maps/hotel/HotelMap"),r=window.hotelRoadMapData||null;r&&$(document).ready(function(){document.querySelector(".hotel-map__load-map").addEventListener("click",function(e){e.currentTarget.parentNode.classList.remove("hotel-map__skeleton-bg"),e.currentTarget.remove(),new n("#hotel-map",{contactsViewLinkTemplate:r.contactsViewLinkTemplate,currentHotel:r.currentHotel})},{once:!0})})},{"../../../../include/maps/hotel/HotelMap":3}],2:[function(e,t,o){var n=(_createClass(r,[{key:"isReady",value:function(){return!1}},{key:"init",value:function(){}},{key:"destroy",value:function(){}},{key:"refresh",value:function(){}}]),r);function r(){_classCallCheck(this,r)}t.exports=n},{}],3:[function(e,t,o){function n(e,t){_classCallCheck(this,n),this.lat=parseFloat(e),this.lng=parseFloat(t)}var r=e("../BaseMap"),a=function e(t){_classCallCheck(this,e),this.id=Number(t.id),this.name=t.name,this.coordinates=new n(t.coordinates.lat,t.coordinates.lng)},s=(_inherits(i,r),_createClass(i,[{key:"isReady",value:function(){return null!==this.map}},{key:"init",value:function(){var e=this;if(this.loadingStarted||0===this.$container.length)return!1;this.loadingStarted=!0,window.ymapLoader.load(function(){e.map=new window.ymaps.Map(e.$container[0],{center:[e.defaultCenter.lat,e.defaultCenter.lng],zoom:e.zoomInit,controls:[]},{minZoom:e.zoomBounds.min,maxZoom:e.zoomBounds.max}),e.map.controls.add("zoomControl",{float:"none",position:{top:10,right:10},size:"small"}),window.ymapLoader.addToStorage(e,e.$container),e.map.geoObjects.add(e._createPlacemark(e.currentHotel)),e.refresh()})}},{key:"destroy",value:function(){if(!this.isReady())return!1;this.map.destroy()}},{key:"refresh",value:function(){if(!this.isReady())return!1;this.map.container.fitToViewport()}},{key:"_createPlacemark",value:function(e){return new window.ymaps.Placemark([e.coordinates.lat,e.coordinates.lng],{balloonContentHeader:e.name,balloonContentBody:this.contactsViewLinkTemplate.split("{{id}}").join(""+e.id)},{hasBalloon:!0,hasHint:!1,hideIconOnBalloonOpen:!1,preset:"islands#icon",iconColor:"#0095b6"})}}]),i);function i(e,t){_classCallCheck(this,i);var o=_possibleConstructorReturn(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return o.$container=$(e).first(),o.zoomBounds={min:11,max:18},o.zoomInit=16,o.loadingStarted=!1,o.contactsViewLinkTemplate=t.contactsViewLinkTemplate||"",o.currentHotel=new a(t.currentHotel),o.defaultCenter=o.currentHotel.coordinates,o.map=null,o.init(),o}t.exports=s},{"../BaseMap":2}]},{},[1]);
//# sourceMappingURL=hotelCatalog.min.js.map
